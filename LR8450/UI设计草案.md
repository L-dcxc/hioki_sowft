# LR8450 数据采集软件 UI 设计草案

## 设计目标
- 风格：简洁工业化，突出数据展示，保持深色波形区与浅色控制区对比。
- 体验：采集期间界面需保持流畅，控件响应即时；关键操作（开始/停止/保存）显式可达。
- 结构：主界面聚焦实时波形，同时兼顾通道设置、报警列表以及文件/连接操作。

## 主界面布局

```
┌──────────────────────────────────────────────────────────────┐
│ 顶部功能栏（菜单 + 快捷工具条）                             │
├──────────────────────────────────────────────────────────────┤
│ 采集控制条（连接状态、开始/停止、速率、时间轴缩放 等）     │
├──────────────────────────────────────────────────────────────┤
│ 主工作区                                                     │
│ ┌─────────────────────────────┬────────────────────────────┐ │
│ │ 实时波形面板（主视图）      │ 右侧分栏（可折叠）         │ │
│ │ - 支持分页/滚动/光标        │ - 通道列表/分组            │ │
│ │ - A/B 光标条                │ - 报警/事件列表             │ │
│ │ - 事件标记刻度              │ - 参数监视/数值面板         │ │
│ └─────────────────────────────┴────────────────────────────┘ │
├──────────────────────────────────────────────────────────────┤
│ 底部工作区（数值表格 / Log / Excel 推送状态）               │
└──────────────────────────────────────────────────────────────┘
```

### 顶部功能栏
- 左侧菜单：`文件`（打开/保存工程、导入导出 LUW/MEM/CSV、最近文件、退出）、`视图`（切换布局、浮动窗口）、`帮助`。
- 工具条：打开、保存、启动 Excel 推送、导出 CSV、截图/硬拷贝、设置入口。

### 采集控制条
- 连接指示灯（LAN/USB 状态、设备名/IP）。
- `连接设置` 按钮（弹出配置对话框，见“设置对话框”）。
- `测量开始` / `测量停止` / `暂停` 按钮；显示当前采样速率与记录时间。
- 事件标记按钮、自动保存状态、Excel 推送开关。

### 主工作区
#### 实时波形面板
- 主画布占据约 70~75% 宽度，深色背景网格（仿 Logger Utility）。
- 支持多页（分页 Tabs 或分页选择器），上下文显示当前页/通道组合。
- 顶部或底部提供时间轴缩放条、A/B 光标位置显示、测量值读数。

#### 右侧分栏
- Tab 控件垂直布局，参考 Logger Utility：`通道`、`报警`、`测量值`、`事件`、`记录` 等。
- 每个 Tab 内部采用 `QTreeView` 或 `QTableView` 展示，可折叠/隐藏。
- 右上角提供折叠/展开按钮以释放更多波形空间。

### 底部工作区
- `QTableView` 展示数值/日志数据（可多 Sheet Tab 切换）。
- Excel 模板/推送状态栏、实时数据快照按钮、错误消息区域。

## 设置对话框（多步骤向导）
参考 Logger Utility，采用 `QStackedWidget` 或 `QWizard` 风格，顶部分布式按钮：

1. **连接设置**：选择接口（LAN/USB）、输入 IP/端口/超时、Ping/测试按钮、设备识别结果。
2. **单元构成**：检测到的单元列表、插槽状态、固件版本；异常提示（如当前损坏单元）。
3. **通道设置**：按单元、通道显示（表格），可批量操作量程、滤波、报警、缩放。
4. **测量设置**：采样间隔、记录时间、触发模式、保存策略 (LUW/LUS)、事件标记规则。
5. **波形运算/分析**：配置计算通道、温升比对、压降分析等。
6. **完成**：汇总配置、保存模板、立即应用。

每步底部提供 `应用` / `下一步` / `取消`，右上角 `帮助` 链接。

## 状态与反馈元素
- 全局状态栏（窗口底部）：显示连接状态、当前通道数、采集 FPS、缓存使用率、Excel 推送状态、告警图标。
- 弹窗通知（`QSystemTrayIcon` 或非阻塞对话框）用于显示错误、报警事件、保存成功等。
- 日志窗口（可停靠）显示操作记录、设备返回的错误码。

## 响应式与性能建议
- 主窗口采用 `QMainWindow` + `QDockWidget` 布局，允许用户自定义停靠。
- 波形绘制使用 `pyqtgraph`，开启 OpenGL 加速、LOD 渲染，支持数据降采样。
- 后台采集线程通过信号槽推送 UI，避免在 GUI 线程中执行耗时工作。
- UI 更新频率与采样频率解耦（例如 UI 10~20 FPS，数据缓存独立处理）。

## 下一步
1. 结合此草案补充详细线框（标注尺寸、间距、颜色）。
2. 制定 PySide6 工程结构与组件接口（见 `UI 组件规划` 文档）。
3. 实现主窗口骨架和设置对话框框架，使用假数据填充，验证布局与性能。

