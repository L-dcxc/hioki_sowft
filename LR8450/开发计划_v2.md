# XY2580 数据采集软件开发计划 v2.0

> 基于实际需求和设备测试结果制定的详细开发计划

## 项目概况

### 产品定位
- **产品名称**: XUNYU XY2580 数据采集与分析软件
- **目标设备**: 兼容HIOKI LR8450/LR8450-01 Memory HiLogger
- **主要应用**: 电压、温度、湿度等多通道数据采集
- **通信方式**: LAN (TCP/IP) / USB
- **开发公司**: 广州讯屿科技有限公司

### 技术架构
- **编程语言**: Python 3.11+
- **GUI框架**: PySide6
- **绘图引擎**: pyqtgraph (高性能实时绘图)
- **设备通信**: TCP/IP Socket + SCPI命令
- **数据处理**: NumPy + Pandas

## 当前状态 (Phase 1 已完成)

### ? 已实现功能
1. **基础架构**
   - [x] 项目结构和配置系统
   - [x] XUNYU品牌映射和设备识别
   - [x] 主窗口和基础UI布局

2. **设备连接**
   - [x] TCP/IP通信封装
   - [x] 设备自动发现和手动连接
   - [x] HIOKI IDN格式解析和品牌映射

3. **用户界面**
   - [x] 主窗口 (菜单、工具栏、状态栏)
   - [x] 波形显示面板 (基础版本)
   - [x] 数据表格和日志
   - [x] 右侧波形设置面板
   - [x] 完整的4步设置向导

4. **文件处理**
   - [x] LUW/LUS/MEM/CSV文件格式支持框架
   - [x] 文件打开和显示功能

### ?? 当前已知问题
1. **设备通信**: 部分SCPI命令超时 (`:ERRor?`, `:MEMory:GETReal`)
2. **界面布局**: 数据表格区域过小，右侧面板需要滚动条
3. **数据采集**: 使用模拟数据，未实现真实设备数据获取

## Phase 2: 核心功能实现 (当前阶段)

### ? 优先级1: 界面完善 (1-2天)

#### 2.1 界面布局优化
- [x] 修复数据表格高度问题
- [x] 为右侧设置面板添加滚动条
- [ ] 优化dock窗口的默认比例
- [ ] 添加光标操作功能栏

#### 2.2 波形显示增强
- [ ] **多量规支持** - 实现最多8个不同纵轴量程
- [ ] **通道颜色管理** - 每个通道独立颜色配置
- [ ] **时间轴控制** - 从50ms到2天的时间格设置
- [ ] **背景切换** - 黑白背景实时切换

### ? 优先级2: 设备集成 (2-3天)

#### 2.3 真实设备通信
- [ ] **命令兼容性分析** - 测试设备支持的SCPI命令集
- [ ] **数据获取优化** - 解决`:MEMory:GETReal`超时问题
- [ ] **多模块支持** - 支持U8552等不同采集模块
- [ ] **30通道管理** - 实现多通道数据采集

#### 2.4 设备设置同步
- [ ] **"接受设置"功能** - 从设备读取配置信息
- [ ] **自动通道检测** - 根据模块类型自动配置通道
- [ ] **设置双向同步** - 设备?软件设置同步
- [ ] **单元信息显示** - 显示连接的采集模块信息

### ? 优先级3: 数据采集核心 (3-4天)

#### 2.5 实时数据采集
- [ ] **真实数据流** - 实现设备实时数据获取
- [ ] **多通道缓冲** - 高性能数据缓冲机制
- [ ] **采样率控制** - 可配置的采样间隔
- [ ] **数据完整性** - 错误检测和恢复机制

#### 2.6 通道配置系统
- [ ] **通道开关控制** - 启用/禁用特定通道
- [ ] **采集类型设置** - 电压/温度/湿度等类型配置
- [ ] **量程自动匹配** - 根据采集类型设置合适量程
- [ ] **单元名称和注释** - 用户自定义通道标识

### ? 优先级4: 数据管理 (2-3天)

#### 2.7 数据存储
- [ ] **LUW格式保存** - 实现HIOKI原生格式保存
- [ ] **CSV导出优化** - 多格式数据导出
- [ ] **Excel集成** - 实时Excel数据推送
- [ ] **数据归档** - 历史数据管理

#### 2.8 分析功能
- [ ] **基础统计** - 最大值、最小值、平均值计算
- [ ] **数据筛选** - 时间范围和通道筛选
- [ ] **趋势分析** - 数据变化趋势显示

## Phase 3: 高级功能 (后续版本)

### ? 扩展功能
- [ ] **多设备支持** - 同时连接多台设备
- [ ] **触发功能** - 数据采集触发条件
- [ ] **报警系统** - 阈值监控和报警
- [ ] **远程监控** - 网络远程访问
- [ ] **自动化脚本** - 批量测试和自动化

## 实施路线图

### Week 1: 核心功能
```
Day 1-2: 界面完善
├── 修复布局问题
├── 实现多量规显示
└── 完善波形设置功能

Day 3-4: 设备通信优化  
├── 解决SCPI命令超时
├── 实现真实数据采集
└── 测试多通道功能

Day 5: 设置同步
├── 实现"接受设置"功能
├── 设备配置自动读取
└── 通道信息同步
```

### Week 2: 完善和测试
```
Day 6-7: 数据处理
├── 实时数据缓冲优化
├── 多通道数据解析
└── 性能优化

Day 8-9: 文件处理
├── LUW格式完善
├── 数据导出功能
└── Excel集成测试

Day 10: 系统测试
├── 完整功能测试
├── 性能压力测试
└── 用户体验优化
```

## 技术重点

### 关键挑战
1. **设备兼容性** - 解决SCPI命令差异
2. **实时性能** - 30通道高频数据采集
3. **多量规显示** - 复杂的Y轴管理
4. **数据完整性** - 长时间稳定采集

### 解决策略
1. **渐进式开发** - 先实现基础功能，再扩展
2. **模块化设计** - 独立的功能模块便于测试
3. **用户反馈驱动** - 根据实际使用优化功能
4. **性能优先** - 实时性和稳定性优于功能丰富性

## 验收标准

### 最小可用产品 (MVP)
- [x] 设备连接和识别
- [ ] 至少4通道实时数据采集
- [ ] 基础波形显示和数据表格
- [ ] 设备设置读取和配置
- [ ] 数据文件保存和导出

### 完整产品
- [ ] 30通道全功能采集
- [ ] 8量规多轴显示  
- [ ] 完整的设置同步
- [ ] Excel集成和数据分析
- [ ] 稳定的长时间运行

---

**备注**: 此计划基于当前已实现的功能和设备测试结果制定，将根据开发进度和需求变化动态调整。
