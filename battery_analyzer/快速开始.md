# 电池分析软件 - 快速开始指南

## 🚀 一分钟快速启动

### 1. 安装依赖

```bash
# 必需的库
pip install PySide6 pyqtgraph numpy

# USB连接支持（可选）
pip install pyserial

# Excel导出支持（可选）
pip install openpyxl
```

### 2. 运行程序

```bash
python battery_analyzer/main.py
```

---

## 🔌 两种连接方式

### 方式一：TCP/IP 网络连接（推荐）

**适用场景：** 实验室、固定测试环境

**步骤：**
1. 点击"设备连接"
2. 选择"TCP/IP 网络连接"
3. 输入设备IP（如：192.168.2.136）
4. 端口保持8802
5. 点击"连接"

### 方式二：USB 串口连接（备用）

**适用场景：** 现场测试、无网络环境

**前提：** 
- 安装HIOKI USB驱动
- 安装pyserial：`pip install pyserial`

**步骤：**
1. USB线连接设备到电脑
2. 点击"设备连接"
3. 选择"USB 串口连接"
4. 点击"刷新端口列表"
5. 选择COM端口
6. 点击"连接"

---

## 📊 基本测试流程

### 1. 配置通道

点击"通道配置" → 设置4个通道：
- 三元电池电压（如：CH2_1）
- 三元电池温度（如：CH2_3）
- 刀片电池电压（如：CH2_5）
- 刀片电池温度（如：CH2_7）

### 2. 填写信息

- 产品型号
- 产品流水号
- 测试员姓名

### 3. 开始测试

点击"开始采集" → 观察波形 → 点击"停止采集"

### 4. 导出报告

点击"导出报告" → 选择格式（TXT/Excel/HTML）→ 保存

---

## 🎯 主要功能

| 功能 | 说明 |
|------|------|
| **实时波形** | 双Y轴显示电压（0-10V）和温度（0-260°C） |
| **数据分析** | 温升、压降、对比分析 |
| **mX+b校准** | 线性校准电压数据 |
| **mAh测试** | 电池容量测试 |
| **波形管理** | 保存/召回历史数据 |
| **报告导出** | TXT/Excel/HTML格式 |

---

## ⚠️ 注意事项

### 设备连接失败？

软件会自动切换到**虚拟数据模式**，生成模拟数据用于演示。

### USB连接问题？

1. 检查USB驱动是否安装
2. 检查USB线是否连接
3. 检查设备是否开机
4. 尝试刷新COM端口列表

### 推荐配置

- **优先使用TCP/IP** - 更稳定、更快
- **USB作为备用** - 适合现场测试

---

## 📁 详细文档

- **USB连接使用说明.md** - USB连接详细指南
- **battery_analyzer/core/lr8450_client.py** - 设备通信代码
- **battery_analyzer/ui/main_window.py** - 主界面代码

---

## 🎉 开始测试

现在你已经准备好了！

1. 运行程序：`python battery_analyzer/main.py`
2. 连接设备（TCP或USB）
3. 配置通道
4. 开始测试

**祝测试顺利！** 🚀

